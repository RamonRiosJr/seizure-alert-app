
> aura-speaks-ai@0.3.0 test:run
> vitest run


[1m[46m RUN [49m[22m [36mv4.0.18 [39m[90mC:/Users/localadmin/OneDrive - Coqui Cloud/Documents/GitHub/seizure-alert-app[39m

 [31mÎ“Â¥Â»[39m components/settings/__tests__/AIHubTab.test.tsx [2m([22m[2m2 tests[22m[2m | [22m[31m2 failed[39m[2m)[22m[32m 32[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m renders AI info and beta warnings[39m[32m 26[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m renders coming soon features as disabled[39m[32m 3[2mms[22m[39m
stderr | hooks/__tests__/useWakeLock.test.ts > useWakeLock > should handle request failure
[useWakeLock] Failed to request wake lock: Error: Failed
    at C:/Users/localadmin/OneDrive - Coqui Cloud/Documents/GitHub/seizure-alert-app/hooks/__tests__/useWakeLock.test.ts:54:35
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:12)

stderr | hooks/__tests__/useWakeLock.test.ts > useWakeLock > should handle NotAllowedError specifically
[useWakeLock] Failed to request wake lock: Error [NotAllowedError]: Permission denied
    at C:/Users/localadmin/OneDrive - Coqui Cloud/Documents/GitHub/seizure-alert-app/hooks/__tests__/useWakeLock.test.ts:66:19
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:12)

 [32mÎ“Â£Ã´[39m hooks/__tests__/useWakeLock.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 112[2mms[22m[39m
 [31mÎ“Â¥Â»[39m components/settings/__tests__/SafetyTab.test.tsx [2m([22m[2m4 tests[22m[2m | [22m[31m4 failed[39m[2m)[22m[32m 47[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m renders all safety sections[39m[32m 32[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m toggles siren preview on button click[39m[32m 4[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m saves custom alert message[39m[32m 5[2mms[22m[39m
[31m     [31mâ”œÃ¹[31m stops alert on unmount[39m[32m 3[2mms[22m[39m
stderr | hooks/__tests__/useTTS.test.ts > useTTS > should handle errors
Native TTS Error: Event { isTrusted: [Getter] }

 [32mÎ“Â£Ã´[39m hooks/__tests__/useTTS.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 50[2mms[22m[39m
[90mstdout[2m | hooks/__tests__/useFallDetection.test.ts[2m > [22m[2museFallDetection[2m > [22m[2mshould trigger alert after High G-Force then Stillness
[22m[39mHigh Impact Detected: 25.00m/sâ”¬â–“
Fall Confirmed: Impact + Stillness

[90mstdout[2m | hooks/__tests__/useFallDetection.test.ts[2m > [22m[2museFallDetection[2m > [22m[2mshould CANCEL alert if Motion occurs after Impact
[22m[39mHigh Impact Detected: 25.00m/sâ”¬â–“
Movement detected after impact - cancelling fall alert (gForce: 15.00)

[90mstdout[2m | hooks/__tests__/useFallDetection.test.ts[2m > [22m[2museFallDetection[2m > [22m[2mshould throttle motion events when Low Power Mode is enabled
[22m[39mHigh Impact Detected: 25.00m/sâ”¬â–“
Movement detected after impact - cancelling fall alert (gForce: 25.00)

 [32mÎ“Â£Ã´[39m hooks/__tests__/useFallDetection.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 64[2mms[22m[39m
[90mstdout[2m | hooks/__tests__/usePWAInstall.test.ts[2m > [22m[2musePWAInstall[2m > [22m[2mshould capture beforeinstallprompt event
[22m[39mâ‰¡Æ’Ã¦Ã¯ PWA Install Prompt captured!

[90mstdout[2m | hooks/__tests__/usePWAInstall.test.ts[2m > [22m[2musePWAInstall[2m > [22m[2mshould detect appinstalled event
[22m[39mâ‰¡Æ’Ã¦Ã¯ PWA Install Prompt captured!
Î“Â£Ã  PWA Installed successfully

 [32mÎ“Â£Ã´[39m hooks/__tests__/usePWAInstall.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 63[2mms[22m[39m
stderr | components/__tests__/ApiKeyWizard.test.tsx > ApiKeyWizard > handles invalid key input
API Verification failed: Error: Invalid API Key
    at C:/Users/localadmin/OneDrive - Coqui Cloud/Documents/GitHub/seizure-alert-app/components/__tests__/ApiKeyWizard.test.tsx:77:43
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:145:11
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:915:26
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1243:20
    at new Promise (<anonymous>)
    at runWithTimeout (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1209:10)
    at file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:37
    at Traces.$ (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/traces.CCmnQaNT.js:142:27)
    at trace (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/vitest/dist/chunks/test.B8ej_ZHS.js:239:21)
    at runTest (file:///C:/Users/localadmin/OneDrive%20-%20Coqui%20Cloud/Documents/GitHub/seizure-alert-app/node_modules/@vitest/runner/dist/index.js:1653:12)

 [32mÎ“Â£Ã´[39m components/__tests__/ApiKeyWizard.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[33m 647[2mms[22m[39m
     [33m[2mÎ“Â£Ã´[22m[39m handles invalid key input [33m 342[2mms[22m[39m
 [32mÎ“Â£Ã´[39m hooks/__tests__/useLocalStorage.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 73[2mms[22m[39m
 [32mÎ“Â£Ã´[39m components/settings/__tests__/DevicesTab.test.tsx [2m([22m[2m2 tests[22m[2m)[22m[32m 76[2mms[22m[39m
 [32mÎ“Â£Ã´[39m components/settings/__tests__/PeopleTab.test.tsx [2m([22m[2m4 tests[22m[2m)[22m[32m 167[2mms[22m[39m
[90mstdout[2m | hooks/__tests__/useBLE.test.ts[2m > [22m[2museBLE Auto-Reconnect[2m > [22m[2mshould attempt reconnect if disconnected accidentally
[22m[39mSimulating disconnect...
device 123 disconnected
Accidental disconnect detected. Initiating auto-reconnect...
Attempting to reconnect to 123...

[90mstdout[2m | hooks/__tests__/useBLE.test.ts[2m > [22m[2museBLE Auto-Reconnect[2m > [22m[2mshould attempt reconnect if disconnected accidentally
[22m[39mReconnected successfully!

[90mstdout[2m | hooks/__tests__/useBLE.test.ts[2m > [22m[2museBLE Auto-Reconnect[2m > [22m[2mshould NOT attempt reconnect if disconnected manually
[22m[39mdevice 123 disconnected
Manual disconnect completed.

[90mstdout[2m | hooks/__tests__/useHeartMonitor.test.ts[2m > [22m[2museHeartMonitor[2m > [22m[2mshould trigger alert when HR is above threshold (120)
[22m[39m[HeartMonitor] HR 130 > 120. Triggering Alert!

 [32mÎ“Â£Ã´[39m components/settings/__tests__/CareTab.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[33m 435[2mms[22m[39m
     [33m[2mÎ“Â£Ã´[22m[39m renders phone care sections [33m 356[2mms[22m[39m
 [32mÎ“Â£Ã´[39m hooks/__tests__/useBLE.test.ts [2m([22m[2m9 tests[22m[2m)[22m[32m 84[2mms[22m[39m
[90mstdout[2m | hooks/__tests__/useHeartMonitor.test.ts[2m > [22m[2museHeartMonitor[2m > [22m[2mshould throttle HR checks when Low Power Mode is enabled
[22m[39m[HeartMonitor] HR 141 > 120. Triggering Alert!

[90mstdout[2m | hooks/__tests__/useHeartMonitor.test.ts[2m > [22m[2museHeartMonitor[2m > [22m[2mshould execute snooze function
[22m[39m[HeartMonitor] Snoozed alerts for 0.16666666666666666 minutes

 [32mÎ“Â£Ã´[39m hooks/__tests__/useHeartMonitor.test.ts [2m([22m[2m6 tests[22m[2m)[22m[32m 59[2mms[22m[39m
 [32mÎ“Â£Ã´[39m components/__tests__/SettingsScreen.test.tsx [2m([22m[2m3 tests[22m[2m)[22m[32m 116[2mms[22m[39m
stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > renders the alert title correctly
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > starts the timer and increments
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > calls toggleSound when mute button is clicked
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > navigates to "ready" screen when "I'm OK" is clicked
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > displays instructions
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > renders auto-call UI and handles cancellation
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

stderr | components/__tests__/AlertScreen.test.tsx > AlertScreen > opens and closes the patient info modal
An update to AlertScreen inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act

 [32mÎ“Â£Ã´[39m components/__tests__/AlertScreen.test.tsx [2m([22m[2m7 tests[22m[2m)[22m[32m 238[2mms[22m[39m
 [32mÎ“Â£Ã´[39m hooks/__tests__/useShake.test.ts [2m([22m[2m3 tests[22m[2m)[22m[32m 39[2mms[22m[39m
 [32mÎ“Â£Ã´[39m src/test/simple.test.ts [2m([22m[2m1 test[22m[2m)[22m[32m 3[2mms[22m[39m
 [32mÎ“Â£Ã´[39m hooks/__tests__/useEmergencyAlert.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 31[2mms[22m[39m
 [32mÎ“Â£Ã´[39m hooks/__tests__/useBattery.test.ts [2m([22m[2m2 tests[22m[2m)[22m[32m 27[2mms[22m[39m

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â» Failed Tests 6 Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»

 FAIL  components/settings/__tests__/AIHubTab.test.tsx > AIHubTab > renders AI info and beta warnings
 FAIL  components/settings/__tests__/AIHubTab.test.tsx > AIHubTab > renders coming soon features as disabled
Error: useSettings must be used within a SettingsProvider
 Î“Â¥Â» useSettings contexts/SettingsContext.tsx:55:11
     53|   const context = useContext(SettingsContext);
     54|   if (!context) {
     55|     throw new Error('useSettings must be used within a SettingsProvideÎ“Ã‡Âª
       |           ^
     56|   }
     57|   return context;
 Î“Â¥Â» AIHubTab components/settings/AIHubTab.tsx:14:7
 Î“Â¥Â» Object.react_stack_bottom_frame node_modules/react-dom/cjs/react-dom-client.development.js:25904:20
 Î“Â¥Â» renderWithHooks node_modules/react-dom/cjs/react-dom-client.development.js:7662:22
 Î“Â¥Â» updateFunctionComponent node_modules/react-dom/cjs/react-dom-client.development.js:10166:19
 Î“Â¥Â» beginWork node_modules/react-dom/cjs/react-dom-client.development.js:11778:18
 Î“Â¥Â» runWithFiberInDEV node_modules/react-dom/cjs/react-dom-client.development.js:874:13
 Î“Â¥Â» performUnitOfWork node_modules/react-dom/cjs/react-dom-client.development.js:17641:22
 Î“Â¥Â» workLoopSync node_modules/react-dom/cjs/react-dom-client.development.js:17469:41
 Î“Â¥Â» renderRootSync node_modules/react-dom/cjs/react-dom-client.development.js:17450:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[1/6]Î“Ã„Â»

 FAIL  components/settings/__tests__/SafetyTab.test.tsx > SafetyTab > renders all safety sections
 FAIL  components/settings/__tests__/SafetyTab.test.tsx > SafetyTab > toggles siren preview on button click
 FAIL  components/settings/__tests__/SafetyTab.test.tsx > SafetyTab > saves custom alert message
 FAIL  components/settings/__tests__/SafetyTab.test.tsx > SafetyTab > stops alert on unmount
Error: useSettings must be used within a SettingsProvider
 Î“Â¥Â» useSettings contexts/SettingsContext.tsx:55:11
     53|   const context = useContext(SettingsContext);
     54|   if (!context) {
     55|     throw new Error('useSettings must be used within a SettingsProvideÎ“Ã‡Âª
       |           ^
     56|   }
     57|   return context;
 Î“Â¥Â» SafetyTab components/settings/SafetyTab.tsx:49:85
 Î“Â¥Â» Object.react_stack_bottom_frame node_modules/react-dom/cjs/react-dom-client.development.js:25904:20
 Î“Â¥Â» renderWithHooks node_modules/react-dom/cjs/react-dom-client.development.js:7662:22
 Î“Â¥Â» updateFunctionComponent node_modules/react-dom/cjs/react-dom-client.development.js:10166:19
 Î“Â¥Â» beginWork node_modules/react-dom/cjs/react-dom-client.development.js:11778:18
 Î“Â¥Â» runWithFiberInDEV node_modules/react-dom/cjs/react-dom-client.development.js:874:13
 Î“Â¥Â» performUnitOfWork node_modules/react-dom/cjs/react-dom-client.development.js:17641:22
 Î“Â¥Â» workLoopSync node_modules/react-dom/cjs/react-dom-client.development.js:17469:41
 Î“Â¥Â» renderRootSync node_modules/react-dom/cjs/react-dom-client.development.js:17450:11

Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»Î“Ã„Â»[2/6]Î“Ã„Â»


[2m Test Files [22m [1m[31m2 failed[39m[22m[2m | [22m[1m[32m17 passed[39m[22m[90m (19)[39m
[2m      Tests [22m [1m[31m6 failed[39m[22m[2m | [22m[1m[32m75 passed[39m[22m[90m (81)[39m
[2m   Start at [22m 02:17:32
[2m   Duration [22m 9.84s[2m (transform 8.13s, setup 8.37s, import 15.22s, tests 2.36s, environment 81.90s)[22m

